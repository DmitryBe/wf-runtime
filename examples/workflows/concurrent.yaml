id: concurrent_execution_wf
version: 1

input:
  schema:
    type: object
    properties:
      val:
        type: integer
    required:
      - val
    additionalProperties: false

output:
  schema:
    type: object
    properties:
      result:
        type: integer
    required:
      - result
    additionalProperties: false
  input_mapping:
    result: $nodes.sum_all.result

nodes:
  - id: mult_by_2
    kind: python_code
    input_mapping:
      val: $input.val
    code: |
      return {"value": input["val"] * 2}
    output_mapping:
      value: $.value

  - id: mult_by_3
    kind: python_code
    input_mapping:
      val: $input.val
    code: |
      return {"value": input["val"] * 3}
    output_mapping:
      value: $.value

  - id: mult_by_4
    kind: python_code
    input_mapping:
      val: $input.val
    code: |
      return {"value": input["val"] * 4}
    output_mapping:
      value: $.value

  - id: sum_all
    kind: python_code
    input_mapping:
      a: $nodes.mult_by_2.value
      b: $nodes.mult_by_3.value
      c: $nodes.mult_by_4.value
    code: |
      total = input["a"] + input["b"] + input["c"]
      return {"result": total}
    output_mapping:
      result: $.result

edges:
  - from: start
    to: mult_by_2

  - from: start
    to: mult_by_3

  - from: start
    to: mult_by_4

  - from: mult_by_2
    to: sum_all

  - from: mult_by_3
    to: sum_all

  - from: mult_by_4
    to: sum_all

  - from: sum_all
    to: end
